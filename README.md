# Speaker-sentiment-analysis

<br>

# ğŸ™ï¸ ë°œí™”ì ê°ì • íŒë³„ í”„ë¡œì íŠ¸

**ê³ ë ¹ì êµ¬ìˆ  ëŒ€í™” ë°ì´í„° ê¸°ë°˜ ê°ì • ë¶„ì„ ëª¨ë¸**, **SENTI-ORAL**ì…ë‹ˆë‹¤.  
ì§ˆë¬¸â€“ì‘ë‹µ í˜•íƒœì˜ ëŒ€í™”ë¥¼ ì…ë ¥ë°›ì•„, **ë°œí™”ìì˜ ì •ì„œ ìƒíƒœ**ë¥¼ ë¶„ì„í•©ë‹ˆë‹¤.  
íŠ¹íˆ ê³ ë ¹ìì˜ ìƒí™œì‚¬ êµ¬ìˆ  ë°ì´í„° íŠ¹ì„±ì— ë§ì¶°, **ë¶ˆì•ˆ(2ë‹¨ê³„) & ìš°ìš¸(2ë‹¨ê³„)** ì´ 4ê°œì˜ ì ìˆ˜ë¥¼ ì˜ˆì¸¡í•©ë‹ˆë‹¤.

---


## ğŸ“‘ ëª©ì°¨

- [ğŸ“Œ í”„ë¡œì íŠ¸ ì†Œê°œ](#-í”„ë¡œì íŠ¸-ì†Œê°œ)
- [ğŸ¯ í”„ë¡œì íŠ¸ ëª©í‘œ](#-í”„ë¡œì íŠ¸-ëª©í‘œ)
- [ğŸ“‚ í•™ìŠµ ë°ì´í„°](#-í•™ìŠµ-ë°ì´í„°)
- [âœ¨ ì£¼ìš” ê¸°ëŠ¥](#-ì£¼ìš”-ê¸°ëŠ¥)
- [ğŸ›ï¸ ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜](#-ì‹œìŠ¤í…œ-ì•„í‚¤í…ì²˜)
- [ğŸ§  ëª¨ë¸ êµ¬ì„±](#-ëª¨ë¸-êµ¬ì„±)
- [ğŸ“‚ í”„ë¡œì íŠ¸ êµ¬ì¡°](#-í”„ë¡œì íŠ¸-êµ¬ì¡°)
- [âš™ï¸ ì„¤ì¹˜ ë° í™˜ê²½ ì„¤ì •](#-ì„¤ì¹˜-ë°-í™˜ê²½-ì„¤ì •)
- [ğŸš€ ì‹¤í–‰ ë°©ë²•](#-ì‹¤í–‰-ë°©ë²•)
- [ğŸ§ª í‰ê°€ ë° ë¶„ì„](#-í‰ê°€-ë°-ë¶„ì„)
- [ğŸ’¡ ê¶Œì¥ í™˜ê²½](#-ê¶Œì¥-í™˜ê²½)
---

## ğŸ“Œ í”„ë¡œì íŠ¸ ì†Œê°œ

**SENTI-ORAL**ì€ ë…¸ë…„ì¸µ ë°œí™”ì—ì„œ ê°ì • ì‹ í˜¸ë¥¼ í¬ì°©í•˜ê³ ,  
ëŒ€í™” ë‚´ ì •ì„œ ë³€í™”ë¥¼ ì •ëŸ‰ì ìœ¼ë¡œ ë¶„ì„í•˜ëŠ” **ê°ì • íŒë³„ AI ëª¨ë¸**ì…ë‹ˆë‹¤.

- ë©€í‹°í„´ ëŒ€í™”ì—ì„œ **ë§¥ë½ ê¸°ë°˜ ê°ì • ë³€í™” ì¶”ë¡ **  
- **ë¶ˆì•ˆÂ·ìš°ìš¸ ì§€í‘œ**ë¥¼ ê°ê° 2ë‹¨ê³„ë¡œ íŒë³„  
- ê³ ë ¹ì ê·¼í˜„ëŒ€ ê²½í—˜ ì„œì‚¬ ë°ì´í„°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ í•™ìŠµ  

> ì¼ìƒ íšŒìƒÂ·ì „ìŸ ê²½í—˜Â·ê°€ì¡±ì‚¬Â·ì‚¬íšŒ ë³€í™” ê²½í—˜ ë“±  
> **ê°ì •ì´ ë¯¸ë¬˜í•˜ê²Œ ë“œëŸ¬ë‚˜ëŠ” ëŒ€í™” íŒ¨í„´ ë¶„ì„**ì— ìµœì í™”

---

## ğŸ¯ í”„ë¡œì íŠ¸ ëª©í‘œ

- ğŸ’¬ **ì •í™•í•˜ê³  ë§¥ë½ì„ ì´í•´í•œ ì‘ë‹µ ì œê³µ**  
- ğŸ§  **ë‹¤ì¤‘ í„´ ëŒ€í™”ì—ì„œ ë¬¸ë§¥ ìœ ì§€ ë° ìì—°ìŠ¤ëŸ¬ìš´ íë¦„ êµ¬í˜„**  
- ğŸ“š **ì‹¤ì œ ê¸ˆìœµ ë¯¼ì› ì‹œë‚˜ë¦¬ì˜¤ ê¸°ë°˜ ë°ì´í„° í•™ìŠµ**  
- ğŸª¶ **Instruction Tuningìœ¼ë¡œ ê³ í’ˆì§ˆ ì‘ë‹µ ìƒì„±**

---

## ğŸ“‚ í•™ìŠµ ë°ì´í„°

ë³¸ í”„ë¡œì íŠ¸ëŠ” **AI Hub ê³ ë ¹ì¸µ ê·¼í˜„ëŒ€ ìƒí™œì‚¬ êµ¬ìˆ  ë°ì´í„°**ë¥¼ ê¸°ë°˜ìœ¼ë¡œ í•™ìŠµë˜ì—ˆìŠµë‹ˆë‹¤.

> ğŸ“˜ [AI Hub ê³ ë ¹ì ê·¼í˜„ëŒ€ êµ¬ìˆ  ë°ì´í„°](https://www.aihub.or.kr/aihubdata/data/view.do?pageIndex=2&currMenu=115&topMenu=100&srchOptnCnd=OPTNCND001&searchKeyword=&srchDetailCnd=DETAILCND001&srchOrder=ORDER001&srchPagePer=20&srchDataRealmCode=REALM002&aihubDataSe=data&dataSetSn=71703)

- ì§ˆë¬¸â€“ì‘ë‹µ ê¸°ë°˜ êµ¬ìˆ  ëŒ€í™”
- ê°ì • ë¼ë²¨ë§(ë¶ˆì•ˆ 2ë‹¨ê³„ + ìš°ìš¸ 2ë‹¨ê³„)  
- ì„¸ëŒ€Â·ì‹œëŒ€ ê²½í—˜ ê¸°ë°˜ ê°ì • ë°œí™” íŠ¹ì„± ë°˜ì˜  

---

## âœ¨ ì£¼ìš” ê¸°ëŠ¥

### ê³ ë ¹ì ëŒ€í™” ê¸°ë°˜ ê°ì • ì¸ì‹
- ì§ˆë¬¸â€“ì‘ë‹µ í˜•íƒœì˜ êµ¬ìˆ  ë°œí™” ì…ë ¥
- ê³ ë ¹ì ìƒí™œì‚¬Â·ê³¼ê±° ê²½í—˜ ë§¥ë½ ë°˜ì˜
- ë°œí™”ì ì •ì„œ ìƒíƒœì— ê¸°ë°˜í•œ **ë¶ˆì•ˆÂ·ìš°ìš¸ 4-score ë™ì‹œ ì˜ˆì¸¡**

### KoBERT ê¸°ë°˜ í…ìŠ¤íŠ¸ ì •ì„œ í‘œí˜„ í•™ìŠµ
- `skt/kobert-base-v1` ê¸°ë°˜ í•œêµ­ì–´ ë°œí™” ì„ë² ë”©
- ì‹¤ì œ êµ¬ìˆ  ê°ì • ë°ì´í„°ë¡œ **Multi-task Fine-tuning**
- CLS + Hidden sequence í™œìš©í•˜ì—¬ ì„¸ë°€í•œ ê°ì • ì‹ í˜¸ ì¶”ì¶œ
- Fine-tuned ì´í›„ **Freeze â†’ Feature Extractor**ë¡œ ì‚¬ìš©

### FT-Transformer ê¸°ë°˜ ë©”íƒ€ë°ì´í„° ì‹¬ë¦¬ ì¼€ì–´ ëª¨ë¸ë§
- ê³ ë ¹ì íŠ¹ì„± ë°˜ì˜ ë°ì´í„° ì…ë ¥  
  (ì—°ë ¹ëŒ€, ì„±ë³„, í˜¼ì¸ ì—¬ë¶€, ì§€ì—­, êµìœ¡ ì—°ìˆ˜, ë™ê±° ì¸ì› ë“±)
- **ìˆ˜ì¹˜í˜• + ë²”ì£¼í˜• í† í¬ë‚˜ì´ì§• ë° í¬ì§€ì…˜ í•™ìŠµ**
- FT-Transformer Encoderë¡œ ì¸êµ¬ì‚¬íšŒì  ìš”ì¸ íŠ¹ì§•í™”

### Cross-Attention ë©€í‹°ëª¨ë‹¬ ê°ì • Fusion
- FT-Transformer ì¶œë ¥ê³¼ KoBERT hidden state ê°„ **Cross-Attention**
- í…ìŠ¤íŠ¸ ê°ì • í‘œí˜„ + ì¸êµ¬í†µê³„ì  ë§¥ë½ì˜ ìƒí˜¸ ì •ë³´ ê²°í•©
- ë‹¨ìˆœ concatì´ ì•„ë‹Œ **Attention ê¸°ë°˜ ìœµí•© êµ¬ì¡°**
- ìµœì¢… Shared MLP + **4-Head Multi-task Classification**

### íš¨ìœ¨ì  & ì•ˆì •ì  í•™ìŠµ ì „ëµ
- Tokenization ì‚¬ì „ ìºì‹± â†’ í•™ìŠµ ì†ë„ í–¥ìƒ
- KoBERT gradient freezeë¡œ ìì› íš¨ìœ¨í™”
- Warmup + Linear Decay ìŠ¤ì¼€ì¤„ëŸ¬
- Gradient clipping + í‰ê·  Multi-task Loss ì ìš©
- ë¶ˆê· í˜• ê°ì • ì ìˆ˜ ë°ì´í„° ëŒ€ì‘ (balanced fine-tuning ë°ì´í„°)

### ë°ì´í„° ì „ì²˜ë¦¬ ë° ì²˜ë¦¬ íŒŒì´í”„ë¼ì¸
- O/X â†’ Binary, Label Encoding, Standard Scaling
- Fine-tuning ì„¸íŠ¸ì™€ FT-Transformer ì„¸íŠ¸ ë¶„ë¦¬
- Tabular + Text ë³‘ë ¬ ë°ì´í„° ë¡œë”© ë° ìºì‹± Dataset êµ¬ì¡°

### í•™ìŠµ/ì¶”ë¡  ì§€ì›
- KoBERT Multi-task Finetuning ìŠ¤í¬ë¦½íŠ¸ ì œê³µ
- FT-Transformer + Cross-Attention í†µí•© í•™ìŠµ ë£¨í”„
- ëª¨ë¸Â·ìŠ¤ì¼€ì¼ëŸ¬Â·ì¸ì½”ë” ì €ì¥ ë° ë¡œë“œ ì§€ì›
- Evaluation: Accuracy & Weighted-F1 ê³„ì‚°

---

## ğŸ›ï¸ ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜

```
[ê³ ë ¹ì ëŒ€í™” í…ìŠ¤íŠ¸ ì…ë ¥]
        â†“
[í…ìŠ¤íŠ¸ ì •ì œ ë° í† í¬ë‚˜ì´ì§•]
        â†“
[KoBERT Fine-Tuning (Multi-task)]
  â””â”€ ë¶ˆì•ˆ/ìš°ìš¸ 4-score í•™ìŠµ
        â†“
[KoBERT Freeze]
  â””â”€ CLS + Hidden Sequence Feature ì¶”ì¶œ
        â†“
[ê³ ë ¹ì ë©”íƒ€ë°ì´í„° ì…ë ¥]
  â””â”€ ë‚˜ì´/ê°€ì¡±/ì§€ì—­/êµìœ¡/ë™ê±° ë“±
        â†“
[FT-Transformer Encoding]
  â””â”€ ìˆ˜ì¹˜í˜• + ë²”ì£¼í˜• â†’ Tabular Embedding
        â†“
[Cross-Attention Fusion]
  â””â”€ Tabular CLS â†” KoBERT Hidden Attention
        â†“
[Shared MLP]
        â†“
[4-Head Multi-task Output]
  â”œâ”€ Anxiety Score 1 (0~4)
  â”œâ”€ Anxiety Score 2 (0~4)
  â”œâ”€ Depression Score 1 (0~4)
  â””â”€ Depression Score 2 (0~4)
        â†“
[ê°ì • ìŠ¤ì½”ì–´ ë°˜í™˜]
```
---

## ğŸ§  ëª¨ë¸ êµ¬ì„±

**í…ìŠ¤íŠ¸ ì •ì œ ë° í† í¬ë‚˜ì´ì§•**
- êµ¬ìˆ  ë°œí™” ì „ì²˜ë¦¬ (íŠ¹ìˆ˜ê¸°í˜¸ ë° ë¶ˆí•„ìš” í…ìŠ¤íŠ¸ ì •ë¦¬)
- `skt/kobert-base-v1` í† í¬ë‚˜ì´ì € ì ìš©
- ë°œí™” ë¬¸ì¥ â†’ í† í° ì‹œí€€ìŠ¤ ë³€í™˜

â†“

**KoBERT Multi-Task Fine-Tuning**
- ëª¨ë¸: `skt/kobert-base-v1`
- ëª©í‘œ: ë¶ˆì•ˆ/ìš°ìš¸ 4-score ë™ì‹œ ì˜ˆì¸¡
- Fine-tuning í›„ **Freeze** â†’ ì •ì„œ feature extractorë¡œ ì‚¬ìš©
- íŠ¹ì§•: CLS + Hidden embedding í™œìš©

â†“

**ê³ ë ¹ì ë©”íƒ€ë°ì´í„° ì¸ì½”ë”© (FT-Transformer)**
- ìˆ˜ì¹˜í˜• + ë²”ì£¼í˜• feature â†’ Tokenization & Embedding
- í•™ìŠµ ìš”ì†Œ: ë‚˜ì´/ê°€ì¡±ê´€ê³„/ê±°ì£¼/êµìœ¡/ì§€ì—­/ë™ê±° ì¸ì› ë“±
- FT-Transformer Encoderë¡œ ì‹¬ë¦¬Â·í™˜ê²½ì  ìš”ì¸ í•™ìŠµ
- CLS-ê¸°ë°˜ tabular representation ìƒì„±

â†“

**Cross-Attention Fusion**
- Tabular-CLS â†” KoBERT Hidden representation ìƒí˜¸ ì£¼ì˜(attention)
- ë‹¨ìˆœ concatì´ ì•„ë‹Œ **Cross-Attention ì •ë³´ í†µí•©**
- ì„¸ëŒ€Â·í™˜ê²½Â·ì–¸ì–´ ê¸°ë°˜ ê°ì • ì‹ í˜¸ ê²°í•©

â†“

**Shared MLP + Multi-Task Heads**
- ê³µí†µ ê°ì • í‘œí˜„(shared feature) â†’ MLP
- 4ê°œì˜ ë¶„ë¥˜ Head ìˆ˜í–‰  
  - Anxiety Score 1  
  - Anxiety Score 2  
  - Depression Score 1  
  - Depression Score 2  
- ê° task: 0~4 ë“±ê¸‰ ë¶„ë¥˜

â†“

**ìµœì¢… ì¶œë ¥**
- ë°œí™”ìì˜ ë¶ˆì•ˆÂ·ìš°ìš¸ ìƒíƒœ 4-dim ì ìˆ˜ ì˜ˆì¸¡
- ê³ ë ¹ì ê°ì • í‰ê°€ì§€í‘œ ê¸°ë°˜ ì ìˆ˜ ì¶œë ¥

## ğŸ“‚ ë””ë ‰í† ë¦¬ êµ¬ì¡° (Directory Structure)
```
â”œâ”€â”€ artifacts/               # í•™ìŠµëœ ëª¨ë¸, Scaler, Encoder ì €ì¥ì†Œ
â”‚   â”œâ”€â”€ scaler.pkl
â”‚   â”œâ”€â”€ cat_encoders.pkl
â”‚   â””â”€â”€ final_kobert_fttransformer_mlp.pt
â”œâ”€â”€ data/                    # ë°ì´í„°ì…‹ í´ë”
â”‚   â”œâ”€â”€ processed_features_cleaned.json
â”‚   â””â”€â”€ finetune_sqrt_balanced_processed.json
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ data_preprocess.py   # ë°ì´í„° ì „ì²˜ë¦¬ ë° íŒŒìƒë³€ìˆ˜ ìƒì„±
â”‚   â”œâ”€â”€ kobert_finetune.py   # Stage 1: KoBERT ë‹¨ë… Fine-tuning
â”‚   â”œâ”€â”€ fusion_model.py      # FT-Transformer + CrossAttention ëª¨ë¸ ì •ì˜
â”‚   â””â”€â”€ train_fusion.py      # Stage 2: ê²°í•© ëª¨ë¸ í•™ìŠµ (Main)
â”œâ”€â”€ README.md
â””â”€â”€ requirements.txt
```

## âš™ï¸ ì„¤ì¹˜ ë° í™˜ê²½ ì„¤ì • (Installation)

### 1. í™˜ê²½ ìš”êµ¬ì‚¬í•­
* Python 3.8 ì´ìƒ
* PyTorch 1.12 ì´ìƒ (CUDA í™˜ê²½ ê¶Œì¥)

### 2. íŒ¨í‚¤ì§€ ì„¤ì¹˜
```bash
pip install -r requirements.txt
```
---

## ğŸš€ ì‹¤í–‰ ë°©ë²• (Usage)

ë³¸ í”„ë¡œì íŠ¸ëŠ” **ë°ì´í„° ì „ì²˜ë¦¬ â†’ KoBERT íŒŒì¸íŠœë‹ â†’ Fusion ëª¨ë¸ í•™ìŠµ**ì˜ 3ë‹¨ê³„ë¡œ ì§„í–‰ë©ë‹ˆë‹¤.

### Step 1. ë°ì´í„° ì „ì²˜ë¦¬ (Preprocessing)
Raw ë°ì´í„°ì—ì„œ í•™ìŠµ/í…ŒìŠ¤íŠ¸ ì…‹ì„ ë¶„ë¦¬í•˜ê³ , ìˆ˜ì¹˜í˜• ë³€ìˆ˜(StandardScaler) ë° ë²”ì£¼í˜• ë³€ìˆ˜(LabelEncoder) ë³€í™˜ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤.
```bash
python src/data_preprocess.py
```
* **ê²°ê³¼ë¬¼:** `train_df.json`, `test_df.json`, `scaler.pkl`, `cat_encoders.pkl`

### Step 2. KoBERT ë‹¨ë… Fine-tuning (Stage 1)
í…ìŠ¤íŠ¸ ì¸ì½”ë”ì˜ ì´í•´ë„ë¥¼ ë†’ì´ê¸° ìœ„í•´ KoBERTë¥¼ ë¨¼ì € í•™ìŠµì‹œí‚µë‹ˆë‹¤. (Multi-task Learning)
```bash
python src/kobert_finetune.py --epochs 5 --lr 3e-5
```
* **ê²°ê³¼ë¬¼:** `artifacts/fine_tuned_kobert_cls.pt`

### Step 3. Fusion ëª¨ë¸ í•™ìŠµ (Stage 2 - Main)
Fine-tuned KoBERT(Freeze)ì™€ FT-Transformerë¥¼ ê²°í•©í•˜ì—¬ ìµœì¢… í•™ìŠµì„ ì§„í–‰í•©ë‹ˆë‹¤.
```bash
python src/train_fusion.py --epochs 5 --lr 1e-4
```
* **Hyperparameters:**
    * Batch Size: 16
    * Learning Rate: 1e-4
    * Fusion Dimension: 192

---

## ğŸ§ª í‰ê°€ ë° ë¶„ì„ (Results)

Validation Set ê¸°ì¤€, ë‹¨ìˆœ Concat ë°©ì‹ ëŒ€ë¹„ **Cross-Attention** ì ìš© ì‹œ ëª¨ë“  Targetì—ì„œ ì„±ëŠ¥ í–¥ìƒì„ í™•ì¸í–ˆìŠµë‹ˆë‹¤.

| Target | Model Type | Accuracy | F1-Score |
|:---:|:---:|:---:|:---:|
| **Anxiety Score 1** | **Cross-Attention** | **0.882** | **0.871** |
| **Anxiety Score 2** | **Cross-Attention** | **0.926** | **0.917** |
| **Depression Score 1** | **Cross-Attention** | **0.871** | **0.861** |
| **Depression Score 2** | **Cross-Attention** | **0.857** | **0.847** |
---
